/*
 * Orange angular-swagger-ui - v0.5.1
 *
 * (C) 2015 Orange, all right reserved
 * MIT Licensed
 */
"use strict";angular.module("swaggerUi").service("swagger1Converter",["$q","$http","swaggerModules","swaggerLoader",function(a,b,c,d){function e(b,e){var h,i=e.openApiSpec.info||{},k=[];i.contact={email:i.contact},i.license={name:i.license,url:i.licenseUrl},i.termsOfService=i.termsOfServiceUrl,e.openApiSpec.info=i,e.openApiSpec.paths={},e.openApiSpec.definitions={},e.openApiSpec.tags=[],e.openApiSpec.swagger="2.0",angular.forEach(e.openApiSpec.apis,function(a){k.push(d.get({url:e.url+a.path}))}),a.all(k).then(function(a){c.execute(c.BEFORE_CONVERT,a).then(function(){angular.forEach(a,function(a,b){h=e.openApiSpec.apis[b].path,h=h.substring(h.lastIndexOf("/")+1),f(a.openApiSpec,e.openApiSpec,h),g(a.openApiSpec,e.openApiSpec,h),j(a.openApiSpec,e.openApiSpec)}),b.resolve(!0)})["catch"](b.reject)})["catch"](b.reject)}function f(a,b,c){if(b.info.version=b.info.version||a.apiVersion,b.basePath=b.basePath||a.basePath,0===b.basePath.indexOf("http")){var d=angular.element('<a href="'+b.basePath+'"></a>')[0];b.schemes=[d.protocol.replace(":","")],b.host=d.host,b.basePath=d.pathname}b.tags.push({name:c})}function g(a,b,c){var d,e;angular.forEach(a.apis,function(f){d=b.paths[f.path]=b.paths[f.path]||{},angular.forEach(f.operations,function(b){e={},d[b.method.toLowerCase()]={deprecated:angular.isString(b.deprecated)?"true"===b.deprecated:b.deprecated,description:b.notes,summary:b.summary,operationId:b.nickname,produces:b.produces||a.produces,consumes:b.consumes||a.consumes,parameters:b.parameters,responses:e,tags:[c]},h(a,b),i(a,b,e)})})}function h(a,b){angular.forEach(b.parameters,function(b){b["in"]="form"===b.paramType?"formData":b.paramType,b["default"]=b.defaultValue;var c=b.type||b.$ref;a.models&&c&&a.models[c]&&(b.schema={$ref:m(c)},delete b.type)})}function i(a,b,c){var d;angular.forEach(b.responseMessages,function(e){if(d=c[e.code]={description:e.message},e.responseModel)a.models&&a.models[e.responseModel]?d.schema={$ref:m(e.responseModel)}:d.type=e.responseModel;else if(200===e.code&&"void"!==b.type&&(d.schema={type:b.type,$ref:m(b.type)},"array"===b.type)){delete d.schema.$ref;var f=b.items.type||b.items.$ref,g=d.schema.items={};a.models&&a.models[f]?g.$ref=m(f):g.type=f}})}function j(a,b){var c,d=new RegExp("Map\\[string,(.*)\\]"),e=new RegExp("List\\[(.*)\\]"),f=[];angular.forEach(a.models,function(c,g){b.definitions[g]=c,c.subTypes&&f.push(g),angular.forEach(c.properties,function(b){var c=b.type||b.$ref;if(c&&l(c,a))b.$ref=m(c),delete b.type;else if(c&&c.match(d)){delete b.$ref;var f=c.match(d)[1];f&&f.match(e)?(f=f.match(e)[1],b.type="object",b.additionalProperties={type:"array",items:k(f,a)}):(b.type="object",b.additionalProperties=k(f,a))}else b.items?(c=b.items.type||b.items.$ref,l(c,a)&&(b.items.$ref=m(c),delete b.items.type)):b["enum"]&&(b.type="string",delete b.$ref)})}),angular.forEach(f,function(a){var d=b.definitions[a];angular.forEach(d.subTypes,function(d){c=b.definitions[d],c&&(b.definitions[d]={allOf:[{$ref:m(a)},c]})}),delete d.subTypes})}function k(a,b){return l(a,b)?{$ref:m(a)}:{type:a}}function l(a,b){return b.models&&b.models[a]}function m(a){return"#/definitions/"+a}this.execute=function(b){var c=a.defer(),d=b.openApiSpec&&b.openApiSpec.swaggerVersion;return"1.2"===d&&("json"===b.parser||"auto"===b.parser&&"application/json"===b.contentType)?e(c,b):c.resolve(!1),c.promise}}]).run(["swaggerModules","swagger1Converter",function(a,b){a.add(a.BEFORE_PARSE,b,10)}]);