/*
 * Orange angular-swagger-ui - v0.5.0
 *
 * (C) 2015 Orange, all right reserved
 * MIT Licensed
 */
"use strict";angular.module("swaggerUi").service("openApi3Converter",["$q","$http","swaggerModules","swaggerModel",function(a,b,c,d){function e(a,b){b.openApiSpec.swagger="2.0",f(b.openApiSpec),g(b.openApiSpec),l(b.openApiSpec),a.resolve(!0)}function f(a){var b,c=a.servers&&a.servers[0];c&&(b=angular.element('<a href="'+c.url+'"></a>')[0],a.schemes=[b.protocol.replace(":","")],a.host=b.host,a.basePath=b.pathname),delete a.servers,delete a.openapi}function g(a){var b,c,e,f;for(b in a.paths){c=a.paths[b]=d.resolveReference(a,a.paths[b]);for(e in c)m.indexOf(e)>=0&&(f=c[e]=d.resolveReference(a,c[e]),h(a,f),k(a,f))}}function h(a,b){var c,e;b.parameters=b.parameters||[],b.requestBody&&(e=b.requestBody,e.name="body",c=d.resolveReference(a,b.requestBody).content,c&&(delete e.content,c["application/x-www-form-urlencoded"]?(e["in"]="body",e.schema=c["application/x-www-form-urlencoded"].schema):c["multipart/form-data"]?(e["in"]="formData",e.schema=c["application/x-www-form-urlencoded"].schema):c["application/octet-stream"]?(e["in"]="file",e.schema=c["application/octet-stream"].schema):c["application/json"]?(e["in"]="body",e.schema=c["application/json"].schema):(e=null,console.warn("unsupported request body media type",b.operationId,c)),e&&b.parameters.push(e)),delete b.requestBody),angular.forEach(b.parameters,function(c,e){c=b.parameters[e]=d.resolveReference(a,c),i(c),j(c),c.schema.$ref||delete c.schema})}function i(a){angular.forEach(n,function(b){a.schema&&a.schema[b]&&(a[b]=a.schema[b],delete a.schema[b])})}function j(a){angular.forEach(o,function(b){a.schema&&a.schema[b]&&(a[b]=a.schema[b],delete a.schema[b])})}function k(a,b){for(var c in b.responses){var e=!1,f="application/json",g=b.responses[c]=d.resolveReference(a,b.responses[c]);if(g.content&&(g.content[f]&&(e=g.content[f]),e||(f=Object.keys(g.content)[0],e=g.content[f])),e){g.schema=e.schema;var h=d.resolveReference(a,g.schema);"array"===h.type&&(g.schema=h),e.example&&(g.examples={},g.examples[f]=e.example),i(g)}delete g.content}}function l(a){a.securitySchemes=a.components.securitySchemes,delete a.components.securitySchemes}var m=["get","put","post","delete","options","head","patch","trace"],n=["format","minimum","maximum","exclusiveMinimum","exclusiveMaximum","minLength","maxLength","multipleOf","minItems","maxItems","uniqueItems","minProperties","maxProperties","additionalProperties","pattern","enum","default"],o=["type","items"];this.execute=function(b){var c=a.defer(),d=b.openApiSpec&&b.openApiSpec.openapi;return"3.0.0"===d&&("json"===b.parser||"auto"===b.parser&&"application/json"===b.contentType)?e(c,b):c.resolve(!1),c.promise}}]).run(["swaggerModules","openApi3Converter",function(a,b){a.add(a.BEFORE_PARSE,b,10)}]);